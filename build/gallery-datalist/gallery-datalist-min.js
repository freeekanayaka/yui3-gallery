YUI.add("gallery-datalist",function(C){function B(){B.superclass.constructor.apply(this,arguments);}C.mix(B,{NAME:"listview",ATTRS:{formatter:{value:function(F,E){F.set("innerHTML",E);},validator:C.Lang.isFunction},EMPTY_LIST_MESSAGE:{value:"There are no list items",validator:C.Lang.isString}},LIST_NODE_TEMPLATE:"<li></li>"});C.extend(B,C.Widget,{_rootNode:null,_recordSet:null,_chain:null,_createChain:function(){this._chain=new C.Chain();},_createListNode:function(F){var E=C.Node.create(B.LIST_NODE_TEMPLATE);return this._updateListNode(E,F);},_updateListNode:function(F,E){F.setStyle("display","none");F.setAttribute("id",E.getId());this._formatNode(F,E);F.setStyle("display","");return F;},_deleteListNode:function(F){var G=C.one("#"+F.getId()),E=this._recordSet.getRecordIndex(F);G.remove();this._recordSet.deleteRecord(E,1);if(this._recordSet.getLength()===0){this.showMessage(this.get("EMPTY_LIST_MESSAGE"));}},_renderRootNode:function(){var F=C.Node.create("<ul></ul>"),E=this.get("contentBox");E.appendChild(F);this._rootNode=F;},_renderChildren:function(){this._chain.stop();var G=this._recordSet.getRecords(),E=document.createDocumentFragment(),F=0;this._chain.add(C.bind(function(I){var H=this._rootNode.get("children"),J;while(this._rootNode.hasChildNodes()&&H.size()>I.length){J=H.item(H.size()-1);J.detach();this._rootNode.removeChild(J);H=this._rootNode.get("children");}},this,G));this._chain.add(C.bind(function(I){var H=this._rootNode.get("children");H.each(function(K,J,L){this._updateListNode(K,I[J]);F=J+1;},this);},this,G));this._chain.add(C.bind(function(H){C.Array.each(H,function(J,K,L){if(F!==0&&K<=F){return;}var I=this._createListNode(J);E.appendChild(C.Node.getDOMNode(I));},this);},this,G));this._chain.add(C.bind(function(){this._rootNode.appendChild(E);},this));this._chain.run();},addRow:function(H,G){if(!H){return;}var F=this._recordSet.addRecord(H,G),E=this._recordSet.getRecordIndex(F);if(C.Lang.isNumber(E)){this._chain.add(C.bind(function(I){var J=this._createListNode(I);if(E==this._rootNode.get("children").size()){this._rootNode.appendChild(J);}else{this._rootNode.insert(J,G);}},this,F));this._chain.run();return F;}},addRows:function(G,F){if(!G||!C.Lang.isArray(G)){return;}F=F||this._recordSet.getLength();var E=[];C.each(G,function(J,I,H){this._chain.add(C.bind(function(M,L){var K=this.addRow(M,F);if(K){++F;}L.push(K);},this,J,E));},this);this._chain.run();return E;},removeRow:function(F){var E,G;if(typeof F=="string"||F.nodeName){F=C.one(F);if(F){E=this._recordSet.getRecord(F.get("id"));}}else{if(C.Lang.isNumber(F)){E=this._recordSet.getRecord(F);}else{if(F instanceof C.Record){E=F;}}}if(!E){return;}G=E.getData();this._deleteListNode(E);return G;},updateRow:function(F,G){var E;if(C.Lang.isNumber(F)){E=this._recordSet.getRecord(F);if(!E){return;}F=C.one("#"+E.getId());}else{F=C.one(F);if(!F){return;}E=this._recordSet.getRecord(F.get("id"));}E=this._recordSet.updateRecord(E,G);F=this._updateListNode(F,E);return E;},showMessage:function(F){var E=C.Node.create(B.LIST_NODE_TEMPLATE);this._rootNode.appendChild(E);E.set("innerHTML",F);},_formatNode:function(F,E){this.get("formatter").call(this,F,E);},clear:function(){this._recordSet.reset();this._renderChildren();},setRecords:function(E){this._recordSet=E;this._renderChildren();},initializer:function(){this._createChain();},destructor:function(){this.clear();this._rootNode.remove();this._rootNode=null;this._recordSet=null;},renderUI:function(){this._renderRootNode();},bindUI:function(){},syncUI:function(){}});C.ListView=B;function A(){A.superclass.constructor.apply(this,arguments);}C.mix(A,{NAME:"tableview",ATTRS:{}});C.extend(A,C.ListView,{});C.TableView=A;function D(){D.superclass.constructor.apply(this,arguments);}C.mix(D,{name:"chain"});C.extend(D,C.Queue,{id:0,run:function(){var I=this._q[0],H,G,F,E=this;if(!I){return this;}H=I.method||I;G=I.argument||[];F=I.timeout||0;if(!C.Lang.isArray(G)){G=[G];}if(typeof H=="function"){if(F<0){this.id=F;if(I.until){for(;I.until();){H.apply({},G);}}else{if(I.iterations){for(;I.iterations-->0;){H.apply({},G);}}else{H.apply({},G);}}this.next();this.id=0;return this.run();}else{if(I.until){if(I.until()){this.next();return this.run();}}else{if(!I.iterations||!--I.iterations){this.next();}}this.id=setTimeout(function(){H.apply({},G);if(E.id){E.id=0;E.run();}},F);}}return this;},pause:function(){if(this.id>0){clearTimeout(this.id);}this.id=0;return this;},stop:function(){this.pause();this._q=[];return this;}});C.Chain=D;},"@VERSION@",{requires:["gallery-datafinder","queue-promote","collection","widget"]});